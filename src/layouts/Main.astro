---
import { Sidebar } from '../templates/SideBar';
import Navbar from '../navigation/Navbar.astro';
import { AppConfig } from '../utils/AppConfig';
import type { PostItems } from '../types/Content';
import Meta from './Meta.astro';
import '../styles/global.css';

interface Props {
	recents: PostItems[];
	tags: string[];
	meta?: {
		title: string;
		description: string;
		canonical?: string;
		post?: {
			image?: string | null;
			date: string;
			modified_date?: string | null;
		};
		url?: string;
	};
}

const { recents, tags, meta } = Astro.props;
---

<html lang="ja">
	<head>
		{meta ? (
			<Meta
				title={meta.title}
				description={meta.description}
				canonical={meta.canonical}
				post={meta.post}
				url={meta.url}
			/>
		) : (
			<Meta
				title={AppConfig.title}
				description={AppConfig.description}
			/>
		)}
	</head>
	<body class="block">
		<div class="antialiased w-full text-black md:px-0 bg-slate-100 lg:table lg:w-full">
		<!-- 左サイドバー（デスクトップ） -->
		<div class="hidden lg:table-cell lg:w-64 bg-slate-100 lg:align-top">
			<div class="p-5">
				<Sidebar recents={recents} tags={tags} client:load />
			</div>
		</div>

		<!-- メインコンテンツ -->
		<div class="mx-auto px-3 w-full sm:w-auto bg-slate-100 min-h-fit sm:min-h-screen lg:table-cell lg:align-top">
			<div class="border-b border-gray-300 break-all text-center text-zinc-900 font-semibold block">
				<div class="pt-4 pb-8 sm:pb-0">
					<div class="font-semibold text-2xl text-gray-900">
						<a href="/index.html">
							{AppConfig.title}
						</a>
					</div>
					<div class="text-sm sm:hidden">{AppConfig.description}</div>
				</div>
				<div class="sm:hidden">
					<Navbar>
						<li class="mr-5">
							<a href="/index.html">
								Home
							</a>
						</li>
						<li class="mr-5">
							<a href="/about/index.html">
								About
							</a>
						</li>
						<li class="mr-5">
							<a href="/portfolio/index.html">
								Portfolio
							</a>
						</li>
						<!-- <li class="mr-5">
							<a href="/contact/index.html">
								Contact
							</a>
						</li> -->
					</Navbar>
				</div>
			</div>

			<div class="text-base py-5">
				<slot />
			</div>
			
			<!-- 左サイドバー（モバイル/タブレット：記事の下） -->
			<div class="block lg:hidden mt-8">
				<div class="p-5">
					<Sidebar recents={recents} tags={tags} client:load />
				</div>
			</div>
		</div>

		<!-- 右サイドバー（目次：デスクトップのみ） -->
		<div class="hidden lg:table-cell lg:w-64 bg-slate-100 lg:align-top lg:h-screen">
			<div class="p-5 h-full">
				<!-- sticky 専用（overflow を持たせない） -->
				<div class="sticky top-5">
					<!-- スクロール専用 -->
					<div class="max-h-[calc(100vh-40px)] overflow-y-auto">
						<slot name="toc" />
					</div>
				</div>
			</div>
		</div>
		</div>
	</body>
</html>
