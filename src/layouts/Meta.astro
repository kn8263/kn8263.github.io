---
import { AppConfig } from '../utils/AppConfig';
import { addTrailingSlash } from '../utils/Url';

interface Props {
	title: string;
	description: string;
	canonical?: string;
	post?: {
		image?: string | null;
		date: string;
		modified_date?: string | null;
	};
	url?: string;
}

const { title, description, canonical, post, url = '' } = Astro.props;
const baseUrl = '';
const fullUrl = canonical || `${AppConfig.url}${baseUrl}${url}`;
---

<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<link
	rel="apple-touch-icon"
	href={`${baseUrl}/apple-touch-icon.png`}
/>
<link rel="manifest" href="/manifest.json" />
<link
	rel="alternate"
	type="application/rss+xml"
	title={AppConfig.title}
	href="/rss.xml"
/>
<link
	rel="icon"
	type="image/png"
	sizes="32x32"
	href={`${baseUrl}/favicon-32x32.png`}
/>
<link
	rel="icon"
	type="image/png"
	sizes="16x16"
	href={`${baseUrl}/favicon-16x16.png`}
/>
<link
	rel="icon"
	href={`${baseUrl}/favicon.ico`}
/>
<title>{`${title} | ${AppConfig.site_name}`}</title>
<meta
	name="description"
	content={description || AppConfig.description}
/>
<meta name="author" content={AppConfig.author} />
{canonical && <link rel="canonical" href={canonical} />}
<meta
	property="og:title"
	content={`${title} | ${AppConfig.site_name}`}
/>
<meta
	property="og:description"
	content={description || AppConfig.description}
/>
<meta property="og:locale" content={AppConfig.locale} />
<meta
	property="og:site_name"
	content={AppConfig.site_name}
/>
<link
	rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
	integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w=="
	crossorigin="anonymous"
	referrerpolicy="no-referrer"
/>
{post && (
	<>
		<meta property="og:type" content="article" />
		{post.image ? (
			<meta
				property="og:image"
				content={`${AppConfig.url}${baseUrl}/${post.image}`}
			/>
		) : (
			<meta
				property="og:image"
				content={`${AppConfig.url}${baseUrl}/assets/images/author.jpg`}
			/>
		)}
		<meta
			name="twitter:card"
			content="summary_large_image"
		/>
		<meta
			property="article:published_time"
			content={new Date(post.date).toISOString()}
		/>
		{post.modified_date && (
			<meta
				property="article:modified_time"
				content={new Date(post.modified_date).toISOString()}
			/>
		)}
		<script
			type="application/ld+json"
			set:html={JSON.stringify({
				description: description || AppConfig.description,
				author: {
					'@type': 'Person',
					name: AppConfig.author,
				},
				'@type': 'BlogPosting',
				url: fullUrl,
				publisher: {
					'@type': 'Organization',
					logo: {
						'@type': 'ImageObject',
						url: `${AppConfig.url}${baseUrl}/assets/images/logo.png`,
					},
					name: AppConfig.author,
				},
				headline: `${title} | ${AppConfig.site_name}`,
				image: [`${AppConfig.url}${baseUrl}${post.image || ''}`],
				datePublished: new Date(post.date).toISOString(),
				dateModified: post.modified_date
					? new Date(post.modified_date).toISOString()
					: new Date(post.date).toISOString(),
				mainEntityOfPage: {
					'@type': 'WebPage',
					'@id': fullUrl,
				},
				'@context': 'http://schema.org',
			})}
		/>
	</>
)}
